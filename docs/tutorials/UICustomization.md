# UI Customization Tutorial for BlinkReceipt Mobile Web SDK

## Introduction
This guide will cover the basics of customizing the BlinkReceipt Mobile Web SDK for integration into your specific application.

The main approach is to override callbacks (functions run after/during specific application actions/behaviors). There are specific callbacks that handle the behavior/presentation of specific DOM elements that are customizable.

There are 2 types of DOM elements generated by default : *internal* vs. *customizable*. The internal DOM elements are not exposed for you to customize. However, the customizable ones are available from the initial generation (via `createUI`) and throughout the lifecycle of the app's operations, via the callbacks. There are some rare exceptions to this rule, wherein you might see internal elements being acted on in a callback. In these cases it's recommended to leave it intact unless you know exactly what you're doing.

## Customizable vs. Internal DOM Elements

Customizable |
--- |
.brjs-edgeLabel |
#brjs-divButtonBar |
#brjs-tblButtons |
#brjs-btnSecondaryAction |
#brjs-snap |
#brjs-finish |
#brjs-imgSpinner |

Internal |
--- |
#brjs-container |
#brjs-gum |
#brjs-imgStatic |
.brjs-imgStatic-additions |
#brjs-inputImage |

## Callbacks Involving Customizable DOM Elements

Callback | Description
--- | ---
onCreateUI | This callback is invoked during creation of UI elements. You may override this in your instance to customize these specific elements, provided you preserve the `id` attribute values, because internal event bindings will depend on them.
onSnapClick | This callback is invoked when the primary action button is clicked on. In mobile-scanning mode, it toggles between the "camera shutter" and "add frame" functions, while in "static" file-upload mode, it has the "add image" function. Regardless of function, this callback is invoked when this button is clicked on.
onStartStaticScan | This callback is invoked after a static scan is performed (select image).
onStartMobileScan | This callback is invoked after the mobile scan is performed.
onAddScanButtonClicked | This callback is invoked when the plus-sign button is clicked on, to sideline the previously-captured frame and prepare the interface to receive another "click". You may override this in your instance to customize the display of the captured frame(s) and related user interface.
onScanInitiated | This callback is invoked at the point that the camera "snap" button is clicked on but before the "winning" frame has been acquired.
onScanAcquired | This callback is invoked after a scan and after weâ€™ve considered a number of frames from the video stream and chosen the best (winning) one. You may override this in your instance to customize the display of the captured frame and related user interface.
onSendImageToScannerResponded | This callback is invoked after a response returns from the scanning service, requested for captured/selected image(s). It is always invoked regardless of success or error.
onFinished | This callback is invoked once the user has indicated the scanning session is complete.
onBtnSecondaryActionClick | This callback is invoked when the secondary button is clicked. Since our stock UI uses one button for multiple actions, this code decides how to differentiate them. You may want to impelement yours differently, by overriding this. Or you may want to use your own separate buttons, in which case you'd still need to bind them to trigger the respective functions shown here, and null-override this callback.
onCancelScan | This callback is invoked if the user cancels out of the scanning session.
onEndScan | This callback is invoked after `finishClick`, and only after the scan results have returned (it will wait to invoke `onEndScan`), but before `returnResults`.
onUserChoseImage | This callback is invoked in "static" scanning mode once the user has selected an image and it has loaded. It is specific to the input tag of type="file" with id="brjs-inputImage", which is auto-generated by the core (native) code.
onRetakeScan | This callback is invoked after the retaking of a scan ("retake" button).
onClearScan | This callback is invoked after a scan is finished or cancelled, to reset variables and UI elements.
onStreamCaptureSuccess | This callback is invoked when a mobile-scan session has begun and the capture stream has successfully started (the camera is active and waiting for the "snap click").
onStreamCaptureError | This callback is invoked if an error occurs during the scanning session.
onStreamLoadedMetadata | This callback is invoked after the video stream is captured, and the best-quality frame assigned to the main video element as the receipt scan image.

## Required DOM Setup

The application expects a top-level DOM element named `#brjs-container` to contain all the other elements, so this is needed (see the demos for an example).

## How To Override Callbacks

You may override callbacks by redeclaring and redefining them, as shown in the `/demo` directory. Observe the Javascript "override" files `demo.js` and `demo2.js`, which are loaded after the main `/dist/blinkreceipt.js` file. This main/original class file creates the `window.BlinkReceipt` object which is the singleton instance we use for all operations.

Any occurences of the keyword `this` in the methods of the main/original class file, need to be renamed to `BlinkReceipt` in the override file (again, see the demo JS files for examples) since we are referring to the window singleton instance.

If all you are doing is adding to a method instead of modifying it, and don't want to repeat all the code, then a shortcut is to clone the method before it is overridden/customized, and then call the cloned method within the overriding method. You can see this in action by searching on the `parentStub` keyword.

To safely support all browsers, use the keyword `var` instead of `let` in the override JS files, even though the main/original file uses the `let` keyword. This is because the "compiled" version at `/dist/blinkreceipt.js` is transpiled down to use `var` anyway, whereas the override JS files are not transpiled.


## Second Demo To Showcase Camera-Crop Offsets

## Migrating From Older Versions (< 2.0)
